{% extends 'base.html' %}

{% block title %}Correction Choix d'École{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Correction Choix d'École</h1>
    
    {% if success %}
    <div class="alert alert-success">
        <h2 class="h4">Correction réussie!</h2>
        <p>{{ message }}</p>
    </div>
    
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h3 class="h5 mb-0">Résumé des modifications</h3>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <div class="alert alert-info">
                        <h4 class="h6">Types d'abonnement</h4>
                        <p><strong>Avant correction:</strong> {{ trial_count_before }} utilisateurs avec type 'Trial' ou 'trial'</p>
                        <p><strong>Modifiés:</strong> {{ updated_users }} utilisateurs convertis en 'school'</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="alert alert-info">
                        <h4 class="h6">Statuts d'abonnement</h4>
                        <p><strong>Avant correction:</strong> {{ pending_paid_count_before }} utilisateurs avec statut 'pending' ou 'paid'</p>
                        <p><strong>Modifiés:</strong> {{ updated_statuses }} utilisateurs convertis en 'approved'</p>
                    </div>
                </div>
            </div>
            
            <div class="alert alert-success">
                <h4 class="h6">Écoles éligibles après correction</h4>
                <p><strong>Total:</strong> {{ eligible_schools }} écoles</p>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-danger">
        <h2 class="h4">Erreur lors de la correction</h2>
        <p>{{ error }}</p>
    </div>
    {% endif %}
    
    <div class="card">
        <div class="card-body">
            <a href="{{ url_for('diagnostic.school_choice') }}" class="btn btn-primary">Retour au diagnostic</a>
            <a href="{{ url_for('payment.select_school') }}" class="btn btn-success">Tester la sélection d'école</a>
        </div>
    </div>
</div>
{% endblock %}
